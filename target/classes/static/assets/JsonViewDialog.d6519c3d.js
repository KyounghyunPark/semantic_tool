import{j as h,p as A,b as H,r as y,o as O,g as _,f as L,c as g,e as u,T as E,d as N,h as T,_ as J}from"./index.5ded1198.js";var w={exports:{}};(function(a,o){(function(n,p){p()})(h,function(){"use strict";function n(t,e){return typeof e=="undefined"?e={autoBom:!1}:typeof e!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\uFEFF",t],{type:t.type}):t}function p(t,e,c){var i=new XMLHttpRequest;i.open("GET",t),i.responseType="blob",i.onload=function(){m(i.response,e,c)},i.onerror=function(){console.error("could not download file")},i.send()}function s(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch{}return 200<=e.status&&299>=e.status}function l(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var d=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof h=="object"&&h.global===h?h:void 0,v=d.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),m=d.saveAs||(typeof window!="object"||window!==d?function(){}:"download"in HTMLAnchorElement.prototype&&!v?function(t,e,c){var i=d.URL||d.webkitURL,r=document.createElement("a");e=e||t.name||"download",r.download=e,r.rel="noopener",typeof t=="string"?(r.href=t,r.origin===location.origin?l(r):s(r.href)?p(t,e,c):l(r,r.target="_blank")):(r.href=i.createObjectURL(t),setTimeout(function(){i.revokeObjectURL(r.href)},4e4),setTimeout(function(){l(r)},0))}:"msSaveOrOpenBlob"in navigator?function(t,e,c){if(e=e||t.name||"download",typeof t!="string")navigator.msSaveOrOpenBlob(n(t,c),e);else if(s(t))p(t,e,c);else{var i=document.createElement("a");i.href=t,i.target="_blank",setTimeout(function(){l(i)})}}:function(t,e,c,i){if(i=i||open("","_blank"),i&&(i.document.title=i.document.body.innerText="downloading..."),typeof t=="string")return p(t,e,c);var r=t.type==="application/octet-stream",b=/constructor/i.test(d.HTMLElement)||d.safari,x=/CriOS\/[\d]+/.test(navigator.userAgent);if((x||r&&b||v)&&typeof FileReader!="undefined"){var S=new FileReader;S.onloadend=function(){var f=S.result;f=x?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=f:location=f,i=null},S.readAsDataURL(t)}else{var j=d.URL||d.webkitURL,D=j.createObjectURL(t);i?i.location=D:location.href=D,i=null,setTimeout(function(){j.revokeObjectURL(D)},4e4)}});d.saveAs=m.saveAs=m,a.exports=m})})(w,w.exports);var V=w.exports;const I={name:"JsonViewDialog",props:{propsIsDialog:{type:Boolean,required:!0},propsJSON:{type:String,required:!0}},data(){return{isDialog:!1,jsonData:"",dtId:"",options:{fontSize:14,automaticLayout:!0,minimap:{enabled:!1},readOnly:!1},monaco:void 0,editorLangage:"json",formatList:[{value:"JSON",display:"JSON"},{value:"TURTLE",display:"TURTLE"},{value:"RDFXML",display:"RDF/XML"},{value:"RDFJSON",display:"RDF/JSON"},{value:"JSONLD",display:"JSON-LD"}],formatSelectedItem:"JSON"}},created(){this.isDialog=this.propsIsDialog,this.jsonData=this.propsJSON,this.dtId=JSON.parse(this.jsonData)["dt-id"]},methods:{apply(){try{let a=JSON.parse(this.jsonData),o={"dt-id":this.dtId,json:this.jsonData,uuid:this.uuid};fetch("/api/twin/edit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}).then(n=>n.json()).then(n=>{this.emitter.emit("setLoading",!1),n.succeeded?(this.emitter.emit("twinsChanged"),this.returnData=a,this.close()):this.emitter.emit("showErrorDialog",n.data)}).catch(n=>{this.emitter.emit("setLoading",!1),console.error(n),this.emitter.emit("showErrorDialog",n)})}catch{this.emitter.emit("showConfirmDialog",{message:"JSON \uD615\uD0DC\uAC00 \uC62C\uBC14\uB974\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4.",isConfirm:!1})}},close(){this.isDialog=!1},editorWillMount(a){this.monaco=a},editorDidMount(a){this.monaco.editor.defineTheme("myTheme",{base:"vs-dark",inherit:!0,rules:[{background:"#1F2128"}],colors:{"editor.background":"#1F2128"}}),this.monaco.editor.setTheme("myTheme")},onFormatChanged(){if(this.formatSelectedItem=="JSON"||this.formatSelectedItem=="RDFJSON"||this.formatSelectedItem=="JSONLD"?this.editorLangage="json":this.formatSelectedItem=="RDFXML"?this.editorLangage="xml":this.editorLangage="plaintext",this.formatSelectedItem=="JSON")this.options.readOnly=!1,this.jsonData=this.propsJSON;else{this.options.readOnly=!1,this.emitter.emit("setLoading",!0);let a={"dt-id":this.dtId,format:this.formatSelectedItem};fetch("/api/twin/getOtherFormat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(o=>o.json()).then(o=>{this.emitter.emit("setLoading",!1),o.succeeded?this.jsonData=o.data:this.emitter.emit("showErrorDialog",o.data)}).catch(o=>{this.emitter.emit("setLoading",!1),console.error(o),this.emitter.emit("showErrorDialog",o)})}},download(){this.emitter.emit("setLoading",!0);let a={type:"single","dt-id":this.dtId,format:this.formatSelectedItem},o="twin.json";fetch("/api/twin/download",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(n=>{if(n.status===200)return o=n.headers.get("content-disposition").match(new RegExp('(?<=")(?:\\\\.|[^"\\\\])*(?=")'))[0],n.blob();if(n.status===204)return"\uB4F1\uB85D\uB41C TWIN\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.";if(n.status===400)return Promise.reject("\uD30C\uB9AC\uBBF8\uD130\uAC00 \uC62C\uBC14\uB974\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4.");if(n.status==500)return Promise.reject("\uC11C\uBC84\uC5D0\uC11C \uC624\uB958\uAC00 \uBC1C\uC0DD\uD558\uC600\uC2B5\uB2C8\uB2E4.")}).then(n=>{this.emitter.emit("setLoading",!1),typeof n=="string"?this.emitter.emit("showConfirmDialog",{message:n,isConfirm:!1}):w.exports.saveAs(n,o)}).catch(n=>{this.emitter.emit("setLoading",!1),this.emitter.emit("showErrorDialog",n)})},onHidden(a){this.$emit("close",this.returnData)}}};const M={class:"dialogPanel"},R={class:"editPanel"},C={class:"footerPanel"},F={class:"leftPanel"},P={class:"rightPanel"},k={key:0};function B(a,o,n,p,s,l){const d=y("MonacoEditor"),v=y("DxSelectBox"),m=y("DxButton"),t=y("DxPopup");return O(),_(t,{visible:s.isDialog,"onUpdate:visible":o[5]||(o[5]=e=>s.isDialog=e),"drag-enabled":!0,"hide-on-outside-click":!1,"show-close-button":!0,"show-title":!0,width:800,"max-width":"80%",height:"80%",title:"Information",container:"body",onHidden:o[6]||(o[6]=e=>l.onHidden(e))},{default:L(()=>[g("div",M,[g("div",R,[u(d,{options:s.options,language:s.editorLangage,value:s.jsonData,"onUpdate:value":o[0]||(o[0]=e=>s.jsonData=e),onEditorWillMount:l.editorWillMount,onEditorDidMount:l.editorDidMount},null,8,["options","language","value","onEditorWillMount","onEditorDidMount"])]),g("div",C,[g("div",F,[u(v,{items:s.formatList,"value-expr":"value","display-expr":"display",value:s.formatSelectedItem,"onUpdate:value":o[1]||(o[1]=e=>s.formatSelectedItem=e),onValueChanged:l.onFormatChanged,width:"200"},null,8,["items","value","onValueChanged"])]),g("div",P,[u(m,{class:"red",type:"normal",text:"Download",onClick:o[2]||(o[2]=e=>l.download())}),u(E,{name:"fade"},{default:L(()=>[s.formatSelectedItem=="JSON"?(O(),N("div",k,[u(m,{class:"purple",type:"normal",text:"Apply",onClick:o[3]||(o[3]=e=>l.apply())})])):T("",!0)]),_:1}),u(m,{class:"gray",type:"normal",text:"Close",onClick:o[4]||(o[4]=e=>l.close())})])])])]),_:1},8,["visible"])}var W=J(I,[["render",B],["__scopeId","data-v-2c2187e7"]]);export{w as F,W as J};
